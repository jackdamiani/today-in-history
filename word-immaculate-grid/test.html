<!DOCTYPE html>
<html lang="en">
<head>
    <title>Word Immaculate Grid</title>
    <meta name="description" content="Fill in all 16 squares in the word immaculate grid!" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="style.css">
    <script src="dictionary.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px; /* Adds space between sections */
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            max-width: 400px;
        }

        #game-selector {
            display: flex;
            flex-direction: row; /* Stack buttons vertically */
            align-items: center;
            gap: 10px; /* Space between buttons */
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            width: 150px; /* Make buttons uniform */
        }

        button:hover {
            background-color: #ddd;
        }

        .autocomplete-suggestions {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            z-index: 1000;
            max-width: 300px;
        }

        .autocomplete-suggestions div {
            padding: 5px;
            cursor: pointer;
        }

        .autocomplete-suggestions div:hover {
            background-color: #eee;
        }

    </style>
</head>
<body>
    <h1>Word Immaculate Grid</h1>
    <p> How to play: Fill in each square with any English word <br> so that the word fits in both the vertical and horizontal categories</p>
    <p> You are part of the beta testers of the game! Thank you!<br> Please send any feedback to Jack at jack@today-in-history-game.com </p>

    <h2>Select a Game</h2>
    <div id="game-selector">
        
        <button onclick="selectGame(1)">Game 1</button>
        <button onclick="selectGame(2)">Game 2</button>
        <button onclick="selectGame(3)">Game 3</button>
    </div>

    <div class="grid" id="grid"></div>

    <div id="autocomplete" class="autocomplete-suggestions" style="display: none;"></div>

    <script>
        let top1, top2, top3, side1, side2, side3;

        // Load translations
        let categoryTranslations = {};

        // Fetch translations from category_translation.json
        fetch('category_translation.json')
            .then(response => response.json())
            .then(data => {
                categoryTranslations = data;
            })
            .catch(error => console.error('Error loading translations:', error));

        // Function to select a game and display translated categories
        function selectGame(gameNumber) {
            // Define predetermined categories for each game
            const games = {
                1: ["noun", "verb", "adjective", "3letters", "4letters", "5letters"],
                2: ["Category 2A", "Category 2B", "Category 2C", "Category 2D", "Category 2E", "Category 2F"],
                3: ["Category 3A", "Category 3B", "Category 3C", "Category 3D", "Category 3E", "Category 3F"]
            };

            // Assign categories based on game selection
            const selectedCategories = games[gameNumber];
            [top1, top2, top3, side1, side2, side3] = selectedCategories;

            // Display translated categories in the grid
            displayCategories();
        }

        // Function to display translated categories on the grid
        function displayCategories() {
            const categoryElements = {
                top1: document.getElementById('top1'),
                top2: document.getElementById('top2'),
                top3: document.getElementById('top3'),
                side1: document.getElementById('side1'),
                side2: document.getElementById('side2'),
                side3: document.getElementById('side3')
            };

            // Update category elements with translations
            Object.entries(categoryElements).forEach(([key, element]) => {
                const category = eval(key); // Use variable name to get value
                const translation = categoryTranslations[category] || category; // Fallback to the original if no translation
                element.textContent = translation;
            });
        }


        function generateGrid() {
            const gridContainer = document.getElementById("grid");
            gridContainer.innerHTML = ""; // Clear existing grid

            // Row 0: Blank and top categories
            gridContainer.appendChild(createCell("")); // Blank (0,0)
            gridContainer.appendChild(createCell(top1)); // (0,1)
            gridContainer.appendChild(createCell(top2)); // (0,2)
            gridContainer.appendChild(createCell(top3)); // (0,3)

            // Rows 1-3: Side categories and inputs
            [side1, side2, side3].forEach((sideCategory, rowIndex) => {
                gridContainer.appendChild(createCell(sideCategory)); // Side category (1,0), (2,0), (3,0)

                for (let i = 0; i < 3; i++) {
                    const input = document.createElement("input");
                    input.setAttribute("type", "text");
                    input.setAttribute("maxlength", "20");
                    input.addEventListener("input", showAutocomplete);
                    gridContainer.appendChild(input);
                }
            });
        }

        function createCell(content) {
            const cell = document.createElement("div");
            cell.textContent = content;
            cell.style.fontWeight = "bold";
            return cell;
        }

        const autocompleteDiv = document.getElementById("autocomplete");

        function showAutocomplete(event) {
            const query = event.target.value.toLowerCase();
            const inputRect = event.target.getBoundingClientRect();

            if (query.length === 0) {
                autocompleteDiv.style.display = "none";
                return;
            }

            // Filter words that match the query
            const matches = Object.keys(words_dict)
                .filter((word) => word.startsWith(query))
                .slice(0, 5);

            if (matches.length > 0) {
                autocompleteDiv.style.display = "block";
                autocompleteDiv.style.left = `${inputRect.left + window.scrollX}px`;
                autocompleteDiv.style.top = `${inputRect.bottom + window.scrollY}px`;

                // Clear previous suggestions
                autocompleteDiv.innerHTML = "";

                // Add suggestions to the autocomplete div
                matches.forEach((match) => {
                    const suggestion = document.createElement("div");
                    suggestion.textContent = match;
                    suggestion.addEventListener("click", () => {
                        event.target.value = match;
                        autocompleteDiv.style.display = "none";
                    });
                    autocompleteDiv.appendChild(suggestion);
                });
            } else {
                autocompleteDiv.style.display = "none";
            }
        }

        // Hide autocomplete when clicking outside
        document.addEventListener("click", (e) => {
            if (!autocompleteDiv.contains(e.target)) {
                autocompleteDiv.style.display = "none";
            }
        });
    </script>
</body>
</html>
